100 POKE 82,2:POKE 83,39:GOSUB 7000
110 ROUTINE=36864:FLAG=ROUTINE+4:INDEX=ROUTINE+5:SPEEDTAB=ROUTINE+6:CLOSE #2:OPEN #2,4,0,"K:"
120 IF PEEK(1536)<>255 THEN POKE FLAG,2:U=USR(ROUTINE):POKE 1536,255:POKE 1537,12:POKE 1538,0
130 DIM A$(25),B$(25):GOTO 190
140 ? "}":CURSOR=PEEK(88)+PEEK(89)*256+PEEK(82)+40:POKE CURSOR,0:GOSUB 6000
141 POKE 709,PEEK(1537)
150 GET #2,A
160 IF A<ASC("5") AND A>ASC("0") THEN POKE INDEX,A-49:POKE FLAG,1:POKE 756,152:U=USR(ROUTINE)
170 IF A=27 THEN GOSUB 7000:GOTO 190
180 GOTO 150
190 ? " }     ************************"
200 ? "     * Mini banc de titrage *"
210 ? "     * c.1989 Pierre FALLER *"
220 ? "     ************************":? 
230 ? "ECRAN ACTUEL  :";:? PEEK(INDEX)+1
240 ? "VITESSE DE DEFILEMENT :";:U=PEEK(SPEEDTAB+PEEK(INDEX)):IF U=1 THEN ? "RAPIDE"
250 IF U=2 THEN ? "NORMALE"
260 IF U=3 THEN ? "LENTE"
270 ? :? "1_2_3_4 CHOIX    ECRAN"
280 ? "P ___ ÐOLICE     (CHARGER)"
290 ? "C ___ ÃHARGER    ECRAN"
300 ? "S ___ ÓAUVER     ECRAN"
310 ? "V ___ ÖITESSE    DEFILEMENT"
320 ? "F ___ ÆORMATER   DISQUE"
330 ? "M ___ ÍENU DU    DISQUE"
340 ? "A ___ ÁTARI      POLICE"
350 ? "D ___ ÄEFILEMENT ECRAN ";PEEK(INDEX)+1
360 ? "E ___ ÅDITION    ECRAN ";PEEK(INDEX)+1
370 ? "R ___ ÒUN (±²³´   START OPTION)"
371 ? "T ___ ÔEINTES":? 380 TRAP 380:? :? "Tapez votre choix...":GET #2,A:? CHR$(A):IF A>ASC("0") AND A<ASC("5") THEN POKE INDEX,A-49:GOTO 190
390 IF A=ASC("R") OR A=ASC("r") THEN GOTO 140
400 IF A=ASC("M") OR A=ASC("m") THEN GOTO 510
410 IF A=155 THEN GOTO 190
420 IF A=ASC("F") OR A=ASC("f") THEN GOTO 540
430 IF A=ASC("C") OR A=ASC("c") THEN GOTO 580
440 IF A=ASC("S") OR A=ASC("s") THEN GOTO 640
450 IF A=ASC("P") OR A=ASC("p") THEN GOTO 700
460 IF A=ASC("A") OR A=ASC("a") THEN 820
470 IF A=ASC("D") OR A=ASC("d") THEN GOSUB 6000:POKE FLAG,1:U=USR(ROUTINE):GOSUB 7000:GOTO 380
480 IF A=ASC("E") OR A=ASC("e") THEN POKE FLAG,0:U=USR(ROUTINE):GOTO 380
481 IF A=ASC("T") OR A=ASC("t") THEN GOTO 5000
490 IF A=ASC("V") OR A=ASC("v") THEN GOTO 770
500 ? :GOTO 380
510 CLOSE #1:OPEN #1,7,0,"D:*.*":TRAP 530
520 INPUT #1,A$:? A$;"  ";:GOTO 520
530 CLOSE #1:? :? :GOTO 380
540 ? :? "INSERER LE DISQUE A FORMATER":? "ÓIMPLE OU ÄOUBLE DENSITE ?":GET #2,A
550 IF A=ASC("S") OR A=ASC("s") THEN CLOSE #1:XIO 253,#1,0,0,"D:*.*":? :GOTO 380
560 IF A=ASC("D") OR A=ASC("d") THEN CLOSE #1:XIO 254,#1,0,0,"D:*.*"
570 ? :GOTO 380
580 ? "CHARGER ECRAN ";PEEK(INDEX)+1:A$="D:*.ECR":GOSUB 1000
610 ? "NOM DE L'ECRAN ";:INPUT A$:IF A$="" THEN ? :GOTO 380
620 B$="D:":B$(3)=A$:B$(LEN(B$)+1)=".ECR"
630 OPEN #1,4,0,B$:POKE FLAG,4:U=USR(ROUTINE):CLOSE #1:GOTO 380
640 ? "SAUVER  ECRAN ";PEEK(INDEX)+1:CLOSE #1:A$="D:*.ECR":GOSUB 1000
670 ? "NOM DE L'ECRAN ";:INPUT A$:IF A$="" THEN ? :GOTO 380
680 B$="D:":B$(3)=A$:B$(LEN(B$)+1)=".ECR"
690 OPEN #1,8,0,B$:POKE FLAG,5:U=USR(ROUTINE):CLOSE #1:GOTO 380
700 ? "CHARGER POLICE":A$="D:*.FNT":GOSUB 1000
730 ? "NOM DE LA POLICE ";:INPUT A$:IF A$="" THEN ? :GOTO 380
740 B$="D:":B$(3)=A$:B$(LEN(B$)+1)=".FNT"
750 OPEN #1,4,0,B$:POKE FLAG,3:U=USR(ROUTINE):CLOSE #1:GOTO 380
760 OPEN #1,8,0,"D:ULTIMON.FNT":FOR X=152*256 TO X+1023:PUT #1,PEEK(X):NEXT X:CLOSE #1
770 ? :? "VITESSE ÒAPIDE ÎORMALE OU ÌENTE ?":GET #2,B
780 IF B=ASC("R") OR B=ASC("r") THEN POKE SPEEDTAB+PEEK(INDEX),1
790 IF B=ASC("N") OR B=ASC("n") THEN POKE SPEEDTAB+PEEK(INDEX),2
800 IF B=ASC("L") OR B=ASC("l") THEN POKE SPEEDTAB+PEEK(INDEX),3
810 GOTO 190
820 ? "ÏUI POUR POLICE EN ROM":GET #2,B:IF B<>ASC("O") AND B<>ASC("o") THEN ? :? "ANNULATION":GOTO 330
830 ? :? "OK, POLICE EN ROM":POKE FLAG,2:U=USR(ROUTINE):GOTO 380
1000 CLOSE #1:OPEN #1,7,0,A$:TRAP 1030:? 
1010 INPUT #1,A$:IF LEN(A$)=17 THEN ? A$(3,10),"         ";
1020 GOTO 1010
1030 TRAP 380:CLOSE #1:? :? A$:? :RETURN 
5000 ? "COULEUR  ÆOND OU ÃARACTERES":GET #2,B:IF B<>ASC("F") AND B<>ASC("C") AND B<>ASC("c") AND B<>ASC("f") THEN 380
5010 IF B=ASC("C") OR B=ASC("c") THEN 5500
5020 TRAP 5040:? "FOND":? "TEINTE ACTUELLE ";PEEK(1538):? "TEINTE NOUVELLE";:INPUT B
5030 POKE 1538,B
5040 GOTO 380
5500 TRAP 5520:? "CARACTERES":? "TEINTE ACTUELLE ";PEEK(1537):? "TEINTE NOUVELLE";:INPUT B
5510 POKE 1537,B
5520 GOTO 380
6000 POKE 709,PEEK(1537):POKE 710,PEEK(1538):POKE 712,PEEK(1538):RETURN 
7000 POKE 709,12:POKE 710,0:POKE 712,134:RETURN 
